// <auto-generated>
// THIS CODE FILE IS GENERATED BY IndirectX.TypeGenerator.
// DO NOT CHANGE IT.
// </auto-generated>
#nullable enable
using System;
using IndirectX.Interop;
using System.Runtime.InteropServices;
using System.Runtime.CompilerServices;
using IndirectX.Dxgi.Interop;

namespace IndirectX.Dxgi
{
    [Guid("54ec77fa-1377-44e6-8c32-88fd5f44c84c")]
    public unsafe partial class Device : DxgiObject
	{
        private ref readonly DeviceVtbl VtblRef
        {
            [MethodImpl(MethodImplOptions.AggressiveInlining)]
            get => ref Unsafe.AsRef<DeviceVtbl>(*(void**)ComPtr.Native);
        }

	    public Device(ComPtr nativePtr, bool addRef = false) : base(nativePtr, addRef) { }

        public Adapter GetAdapter()
        {
            {
                VtblRef.GetAdapter(ComPtr, out var adapter).HandleResult();
			    return (new Adapter(adapter));
            }
        }

        public Surface CreateSurface(in SurfaceDesc desc, int numSurfaces, Usage usage, in SharedResource sharedResource)
        {
            {
                VtblRef.CreateSurface(ComPtr, in desc, numSurfaces, usage, in sharedResource, out var surface).HandleResult();
			    return (new Surface(surface));
            }
        }

        public Surface CreateSurface(in SurfaceDesc desc, int numSurfaces, Usage usage)
        {
            {
                VtblRef.CreateSurface(ComPtr, in desc, numSurfaces, usage, in Unsafe.NullRef<SharedResource>(), out var surface).HandleResult();
			    return (new Surface(surface));
            }
        }

        private Residency[] QueryResourceResidency(Unknown[] resources)
        {
            var residencyStatus = new Residency[resources.Length];
            using (var p_resources = new InteropArray<Unknown>(resources))
            fixed (Residency* p_residencyStatus = residencyStatus)
            {
                VtblRef.QueryResourceResidency(ComPtr, p_resources.NativePtr, p_residencyStatus, resources.Length).HandleResult();
			    return (residencyStatus);
            }
        }

        public void SetGPUThreadPriority(int priority)
        {
            {
                VtblRef.SetGPUThreadPriority(ComPtr, priority).HandleResult();
            }
        }

        public int GetGPUThreadPriority()
        {
            {
                VtblRef.GetGPUThreadPriority(ComPtr, out var priority).HandleResult();
			    return (priority);
            }
        }

        public Adapter Adapter => GetAdapter();

        public int GPUThreadPriority
        {
            get => GetGPUThreadPriority();
            set => SetGPUThreadPriority(value);
        }
	}
}

namespace IndirectX.Dxgi.Interop
{
    [StructLayout(LayoutKind.Sequential)]
	public unsafe struct DeviceVtbl
	{
	    internal DxgiObjectVtbl Base;
        internal delegate* unmanaged[Stdcall]<ComPtr, out ComPtr, HResult> GetAdapter;
        internal delegate* unmanaged[Stdcall]<ComPtr, in SurfaceDesc, int, Usage, in SharedResource, out ComPtr, HResult> CreateSurface;
        internal delegate* unmanaged[Stdcall]<ComPtr, ComPtr*, Residency*, int, HResult> QueryResourceResidency;
        internal delegate* unmanaged[Stdcall]<ComPtr, int, HResult> SetGPUThreadPriority;
        internal delegate* unmanaged[Stdcall]<ComPtr, out int, HResult> GetGPUThreadPriority;
	}
}
